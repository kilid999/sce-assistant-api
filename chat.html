<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Ù…Ø³Ø§Ø¹Ø¯ Ø§Ø§Ù„Ù‡ÙŠØ¦Ø© Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ© Ù„Ù„Ù…Ù‡Ù†Ø¯Ø³ÙŠÙŠÙ†</title>

  <!-- Ø®Ø· Ø¹Ø±Ø¨ÙŠ Ø¬Ù…ÙŠÙ„ -->
  <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;500;700&display=swap" rel="stylesheet" />

  <style>
    :root {
      --primary: #5a3df0;
      --primary-soft: #f5f2ff;
      --bg: #f4f6f9;
      --card: #ffffff;
      --text-main: #222;
      --text-muted: #777;
      --border: #e3e6ee;
      --shadow-soft: 0 14px 40px rgba(15, 23, 42, 0.14);
    }

    * {
      box-sizing: border-box;
    }

    html, body {
      height: 100%;
      margin: 0;
      padding: 0;
      scrollbar-width: none;
    }

    html::-webkit-scrollbar,
    body::-webkit-scrollbar {
      display: none;
    }

    body {
      font-family: "Tajawal", system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      background: radial-gradient(circle at top, #fdf2ff 0, #f4f6f9 45%, #eef4ff 100%);
      direction: rtl;
      overflow-y: auto;
    }

    .page-wrap {
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 16px;
    }

    .chat-shell {
      width: 100%;
      max-width: 480px;
      min-height: 540px;
      background: var(--card);
      border-radius: 24px;
      box-shadow: var(--shadow-soft);
      display: flex;
      flex-direction: column;
      overflow: hidden;
      position: relative;
    }

    /* Ø§Ù„Ù‡ÙŠØ¯Ø± */
    .chat-header {
      height: 64px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 0 16px;
      border-bottom: 1px solid var(--border);
      background: linear-gradient(135deg, #ffffff, #f9f6ff);
    }

    .header-left,
    .header-right {
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .header-logo {
      width: 130px;
      height: 36px;
      border-radius: 8px;
      overflow: hidden;
      display: flex;
      align-items: center;
      justify-content: center;
      background: #f0f2ff;
      border: 1px solid #e0e4ff;
    }

    .header-logo img {
      max-width: 100%;
      max-height: 100%;
      object-fit: contain;
    }

    .header-title-block {
      display: flex;
      flex-direction: column;
    }

    .header-title-main {
      font-size: 14px;
      font-weight: 700;
      color: var(--text-main);
      white-space: nowrap;
    }

    .header-title-sub {
      font-size: 11px;
      color: var(--text-muted);
      white-space: nowrap;
    }

    /* Ø§Ù„Ø¬Ø²Ø¡ Ø§Ù„Ø¹Ù„ÙˆÙŠ: Ø§Ù„ÙƒÙˆØ±Ø© + Ø§Ù„Ù†Øµ */
    .chat-hero {
      padding: 14px 16px 6px;
      text-align: center;
      position: relative;
    }

    .sphere-wrap {
      display: flex;
      align-items: center;
      justify-content: center;
      margin: 6px auto 8px;
    }

    .sphere {
      width: 78px;
      height: 78px;
      border-radius: 50%;
      background: radial-gradient(circle at 30% 25%, #ffe9ff 0, #c793ff 26%, #7a4df2 60%, #3b1eb7 100%);
      position: relative;
      box-shadow:
        0 0 0 8px rgba(128, 90, 213, 0.08),
        0 18px 40px rgba(55, 48, 163, 0.35);
      animation: sphereFloat 3.6s ease-in-out infinite;
    }

    .sphere::before {
      content: "";
      position: absolute;
      width: 34px;
      height: 34px;
      border-radius: 999px;
      background: radial-gradient(circle at 30% 20%, #ffffff 0, #f6ebff 55%, transparent 100%);
      top: 10px;
      right: 10px;
      opacity: 0.8;
      filter: blur(0.5px);
    }

    .sphere::after {
      content: "";
      position: absolute;
      width: 100%;
      height: 18px;
      border-radius: 999px;
      background: radial-gradient(circle, rgba(15, 23, 42, 0.3), transparent 70%);
      bottom: -18px;
      left: 0;
      right: 0;
      margin: auto;
      opacity: 0.4;
      transform: scale(0.85);
      filter: blur(2px);
    }

    .sphere-dots {
      position: absolute;
      inset: 0;
      display: flex;
      align-items: center;
      justify-content: center;
      pointer-events: none;
    }

    .sphere-dots span {
      width: 6px;
      height: 6px;
      border-radius: 999px;
      margin: 0 3px;
      background: rgba(255, 255, 255, 0.9);
      opacity: 0;
      transform: translateY(6px);
    }

    .sphere-dots.active span {
      animation: bounceDots 1.1s infinite.ease-in-out;
    }

    .sphere-dots.active span:nth-child(2) {
      animation-delay: 0.12s;
    }
    .sphere-dots.active span:nth-child(3) {
      animation-delay: 0.24s;
    }

    .chat-hero-title {
      font-size: 18px;
      font-weight: 700;
      color: var(--text-main);
      margin: 6px 0 4px;
    }

    .chat-hero-sub {
      font-size: 13px;
      color: var(--text-muted);
      max-width: 90%;
      margin: 0 auto 8px;
      line-height: 1.6;
    }

    .chips-row {
      display: flex;
      gap: 8px;
      overflow-x: auto;
      padding: 4px 4px 2px;
      justify-content: center;
      scrollbar-width: none;
    }

    .chips-row::-webkit-scrollbar {
      display: none;
    }

    .chip {
      flex-shrink: 0;
      padding: 6px 10px;
      border-radius: 999px;
      border: 1px solid #e1e3f0;
      background: #f9f9ff;
      font-size: 11px;
      color: #4b5563;
      cursor: pointer;
      white-space: nowrap;
      display: inline-flex;
      align-items: center;
      gap: 6px;
      transition: background 0.15s ease, border-color 0.15s ease, transform 0.12s ease;
    }

    .chip-dot {
      width: 6px;
      height: 6px;
      border-radius: 999px;
      background: var(--primary);
      opacity: 0.7;
    }

    .chip:hover {
      background: #eff0ff;
      border-color: #d0d4ff;
      transform: translateY(-1px);
    }

    /* Ø§Ù„Ø±Ø³Ø§Ø¦Ù„ â€“ Ù…ØµØºÙ‘Ø±Ø© */
    .chat-body {
      flex: 1;
      padding: 4px 10px 4px;  /* â†“ ØªÙ‚Ù„ÙŠÙ„ Ø§Ù„Ù…Ø³Ø§Ø­Ø§Øª Ø§Ù„Ø¹Ø§Ù…Ø© */
      overflow-y: auto;
      overflow-x: hidden;
      background:
        radial-gradient(circle at top, #fdf7ff 0, #ffffff 52%, #f4f6fb 100%);
      scroll-behavior: smooth;
      -webkit-overflow-scrolling: touch;
      scrollbar-width: none;
    }

    .chat-body::-webkit-scrollbar {
      display: none;
    }

    .message-group {
      margin-bottom: 4px;  /* â†“ ØªÙ‚Ù„ÙŠÙ„ Ø§Ù„Ù…Ø³Ø§ÙØ© Ø¨ÙŠÙ† Ø§Ù„Ø¨Ø§Ù„ÙˆÙ†Ø§Øª */
      display: flex;
      flex-direction: column;
      gap: 2px;
    }

    .msg {
      max-width: 85%;
      padding: 6px 9px;    /* â†“ ØªØµØºÙŠØ± Ø§Ù„Ø­ÙˆØ§Ù */
      border-radius: 14px;
      font-size: 13px;
      line-height: 1.5;    /* â†“ ØªÙ‚Ù„ÙŠÙ„ Ø§Ø±ØªÙØ§Ø¹ Ø§Ù„Ø³Ø·Ø± */
      word-wrap: break-word;
      white-space: pre-wrap;
    }

    .msg.assistant {
      align-self: flex-start;
      background: #ffffff;
      border: 1px solid #ecefff;
      box-shadow: 0 4px 10px rgba(15, 23, 42, 0.05);
      border-bottom-right-radius: 4px;
    }

    .msg.user {
      align-self: flex-end;
      background: linear-gradient(135deg, #5a3df0, #8a6dff);
      color: #ffffff;
      border-bottom-left-radius: 4px;
    }

    .msg-meta {
      font-size: 11px;
      color: var(--text-muted);
      display: flex;
      align-items: center;
      gap: 4px;
      margin: 0 4px 2px;
    }

    .msg-actions {
      margin-top: 2px;
      display: flex;
      flex-wrap: wrap;
      gap: 4px;
      font-size: 10px;
    }

    .msg-action-btn {
      padding: 3px 6px;
      border-radius: 999px;
      border: 1px solid #e5e7f5;
      background: #fafbff;
      color: #6b7280;
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      gap: 4px;
      transition: background 0.15s.ease, border-color 0.15s.ease, transform 0.12s ease;
    }

    .msg-action-btn:hover {
      background: #eef0ff;
      border-color: #d3d7ff;
      transform: translateY(-1px);
    }

    .msg-action-btn[disabled] {
      opacity: 0.5;
      cursor: default;
      transform: none;
    }

    .msg-action-emoji {
      font-size: 13px;
    }

    /* Ø³Ø·Ø± Ø§Ù„ÙƒØªØ§Ø¨Ø© */
    .chat-footer {
      border-top: 1px solid var(--border);
      background: #f9fafb;
      padding: 8px 10px;
    }

    .input-row {
      display: flex;
      align-items: flex-end;
      gap: 8px;
    }

    .input-wrap {
      flex: 1;
      position: relative;
    }

    .chat-input {
      width: 100%;
      resize: none;
      min-height: 40px;
      max-height: 80px;
      padding: 8px 10px;
      padding-left: 32px;
      border-radius: 14px;
      border: 1px solid #d4d8e6;
      font-family: inherit;
      font-size: 13px;
      line-height: 1.5;
      outline: none;
      background: #ffffff;
      transition: border-color 0.15s ease, box-shadow 0.15s ease, background 0.15s ease;
    }

    .chat-input::placeholder {
      color: #a0a4b4;
    }

    .chat-input:focus {
      border-color: #b3b9ff;
      box-shadow: 0 0 0 1px rgba(99, 102, 241, 0.2);
      background: #ffffff;
    }

    .input-hint {
      position: absolute;
      left: 10px;
      bottom: 6px;
      font-size: 10px;
      color: #9ca3af;
      pointer-events: none;
    }

    .send-btn {
      width: 40px;
      height: 40px;
      border-radius: 999px;
      border: none;
      outline: none;
      background: linear-gradient(135deg, #5a3df0, #8a6dff);
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      box-shadow: 0 8px 20px rgba(88, 80, 236, 0.4);
      transition: transform 0.12s ease, box-shadow 0.12s ease, opacity 0.12s ease;
    }

    .send-btn.disabled {
      opacity: 0.35;
      box-shadow: none;
      cursor: default;
    }

    .send-btn:not(.disabled):active {
      transform: translateY(1px) scale(0.97);
      box-shadow: 0 4px 12px rgba(88, 80, 236, 0.3);
    }

    .send-icon {
      width: 16px;
      height: 16px;
      transform: translateX(1px) rotate(-35deg);
      position: relative;
    }

    .send-icon::before,
    .send-icon::after {
      content: "";
      position: absolute;
      border-radius: 3px;
    }

    .send-icon::before {
      border-top: 2px solid #ffffff;
      border-right: 2px solid #ffffff;
      width: 14px;
      height: 14px;
      transform: rotate(45deg);
      top: 1px;
      right: 0;
    }

    .send-icon::after {
      width: 2px;
      height: 8px;
      background: #ffffff;
      right: 6px;
      bottom: 0;
    }

    .brand-strip {
      text-align: center;
      padding: 4px 10px 8px;
      font-size: 10px;
      color: #9ca3af;
      background: #f9fafb;
      border-top: 1px solid #eef0f6;
    }

    .brand-strip strong {
      font-weight: 600;
      color: #6b7280;
    }

    @keyframes sphereFloat {
      0%   { transform: translateY(0px); }
      50%  { transform: translateY(-8px); }
      100% { transform: translateY(0px); }
    }

    @keyframes bounceDots {
      0%, 70%, 100% {
        transform: translateY(6px);
        opacity: 0.1;
      }
      35% {
        transform: translateY(-2px);
        opacity: 1;
      }
    }

    /* Ù…ÙˆØ¨Ø§ÙŠÙ„ */
    @media (max-width: 520px) {
      .page-wrap {
        padding: 0;
        align-items: stretch;
      }

      .chat-shell {
        max-width: none;
        width: 100%;
        min-height: 100vh;
        border-radius: 0;
        box-shadow: none;
      }

      .chat-header {
        padding: 0 10px;
      }

      .header-logo {
        width: 120px;
        height: 32px;
      }

      .header-title-main {
        font-size: 13px;
      }

      .header-title-sub {
        font-size: 10px;
      }

      .chat-hero {
        padding: 10px 12px 4px;
      }

      .sphere {
        width: 70px;
        height: 70px;
      }

      .chat-hero-title {
        font-size: 16px;
      }

      .chat-hero-sub {
        font-size: 12px;
        margin-bottom: 6px;
      }

      .chat-body {
        padding: 2px 8px 2px !important; /* Ø¶ØºØ· Ø¥Ø¶Ø§ÙÙŠ Ø¹Ù„Ù‰ Ø§Ù„Ø¬ÙˆØ§Ù„ */
      }

      .msg.assistant {
        font-size: 12px;
        padding: 5px 8px;
      }
    }
  </style>
</head>
<body>
  <div class="page-wrap">
    <div class="chat-shell">
      <!-- Ø§Ù„Ù‡ÙŠØ¯Ø± -->
      <header class="chat-header">
        <div class="header-left"></div>
        <div class="header-logo">
          <img src="logo-ncir.png" alt="Ø´Ø¹Ø§Ø± Ø§Ø§Ù„Ù‡ÙŠØ¦Ø© Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ© Ù„Ù„Ù…Ù‡Ù†Ø¯Ø³ÙŠÙŠÙ†" />
        </div>
        <div class="header-right">
          <div class="header-title-block">
            <div class="header-title-main">Ù…Ø³Ø§Ø¹Ø¯ Ø§Ø§Ù„Ù‡ÙŠØ¦Ø© Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ© Ù„Ù„Ù…Ù‡Ù†Ø¯Ø³ÙŠÙŠÙ†</div>
            <div class="header-title-sub">SCE â€¢ ÙˆÙƒÙŠÙ„ Ø±Ù‚Ù…ÙŠ Ø°ÙƒÙŠ</div>
          </div>
        </div>
      </header>

      <!-- Ø§Ù„Ø¬Ø²Ø¡ Ø§Ù„Ø¹Ù„ÙˆÙŠ -->
      <section class="chat-hero">
        <div class="sphere-wrap">
          <div class="sphere">
            <div class="sphere-dots" id="sphereDots">
              <span></span><span></span><span></span>
            </div>
          </div>
        </div>
        <div class="chat-hero-title">ÙƒÙŠÙ ÙŠÙ…ÙƒÙ†Ù†ÙŠ Ù…Ø³Ø§Ø¹Ø¯ØªÙƒ Ø§Ù„ÙŠÙˆÙ…ØŸ</div>
        <p class="chat-hero-sub">
          Ø§Ø³Ø£Ù„ Ø¹Ù† Ø§Ù„Ø®Ø¯Ù…Ø§Øª Ø§Ù„Ù‡Ù†Ø¯Ø³ÙŠØ©ØŒ ÙƒÙˆØ¯ Ø§Ù„Ø¨Ù†Ø§Ø¡ Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØŒ Ø§Ù„Ø§Ø¹ØªÙ…Ø§Ø¯ Ø§Ù„Ù…Ù‡Ù†ÙŠØŒ Ø£Ùˆ Ø§Ø·Ù„Ø¨ Ø´Ø±Ø­Ù‹Ø§ Ù…Ø¨Ø³Ø·Ù‹Ø§ Ù„Ø£ÙŠ Ù„Ø§Ø¦Ø­Ø© Ø£Ùˆ Ø¥Ø¬Ø±Ø§Ø¡ ÙŠØ®Øµ Ø§Ù„Ù‡ÙŠØ¦Ø© Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ© Ù„Ù„Ù…Ù‡Ù†Ø¯Ø³ÙŠÙ†.
        </p>
        <div class="chips-row" id="chipsRow">
          <button class="chip" data-text="Ø§Ø±Ø´Ø¯Ù†ÙŠ Ù„Ø¢Ù„ÙŠØ© Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø§Ù„Ø§Ø¹ØªÙ…Ø§Ø¯ Ø§Ù„Ù…Ù‡Ù†ÙŠ Ù„Ù„Ù…Ù‡Ù†Ø¯Ø³ÙŠÙ†.">
            <span class="chip-dot"></span> Ø¢Ù„ÙŠØ© Ø§Ù„Ø§Ø¹ØªÙ…Ø§Ø¯ Ø§Ù„Ù…Ù‡Ù†ÙŠ
          </button>
          <button class="chip" data-text="Ø£Ø±ÙŠØ¯ Ø´Ø±Ø­Ø§Ù‹ Ù…Ø¨Ø³Ø·Ø§Ù‹ Ø¹Ù† ÙƒÙˆØ¯ Ø§Ù„Ø¨Ù†Ø§Ø¡ Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠ ÙˆÙ…ØªØ·Ù„Ø¨Ø§ØªÙ‡.">
            <span class="chip-dot"></span> Ø´Ø±Ø­ ÙƒÙˆØ¯ Ø§Ù„Ø¨Ù†Ø§Ø¡ Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠ
          </button>
          <button class="chip" data-text="Ù…Ø§ Ù‡ÙŠ Ø®Ø·ÙˆØ§Øª Ø§Ù„ØªÙ‚Ø¯ÙŠÙ… Ø¹Ù„Ù‰ Ø®Ø¯Ù…Ø§Øª Ø§Ù„Ù‡ÙŠØ¦Ø© Ø§Ù„Ù‡Ù†Ø¯Ø³ÙŠØ©ØŸ">
            <span class="chip-dot"></span> Ø®Ø·ÙˆØ§Øª Ø®Ø¯Ù…Ø§Øª Ø§Ù„Ù‡ÙŠØ¦Ø©
          </button>
          <button class="chip" data-text="Ø£Ø±ØºØ¨ ÙÙŠ Ù…Ø¹Ø±ÙØ© Ù…Ø¤Ø´Ø±Ø§Øª Ø§Ù„Ø£Ø¯Ø§Ø¡ ÙˆØ§Ù„Ù…Ø¹Ø§ÙŠÙŠØ± Ø§Ù„Ù‡Ù†Ø¯Ø³ÙŠØ© Ø§Ù„Ù…Ø¹ØªÙ…Ø¯Ø©.">
            <span class="chip-dot"></span> Ù…Ø¤Ø´Ø±Ø§Øª Ø§Ù„Ø£Ø¯Ø§Ø¡ Ø§Ù„Ù‡Ù†Ø¯Ø³ÙŠ
          </button>
        </div>
      </section>

      <!-- Ø§Ù„Ø±Ø³Ø§Ø¦Ù„ (ØªÙ… ØªÙ‚Ù„ÙŠÙ„ Ø§Ù„Ù…Ø³Ø§ÙØ§Øª Ø¯Ø§Ø®Ù„Ù‡Ø§) -->
      <main class="chat-body" id="chatBody">
        <div class="message-group">
          <div class="msg assistant">
            Ø£Ù‡Ù„Ø§Ù‹ Ø¨Ùƒ ğŸ‘‹ØŒ Ø£Ù†Ø§ <strong>ÙˆÙƒÙŠÙ„</strong>ØŒ Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯ Ø§Ù„Ø°ÙƒÙŠ Ù„Ù„Ù‡ÙŠØ¦Ø© Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ© Ù„Ù„Ù…Ù‡Ù†Ø¯Ø³ÙŠÙŠÙ†.<br />
            Ø£Ø³ØªØ·ÙŠØ¹ Ù…Ø³Ø§Ø¹Ø¯ØªÙƒ ÙÙŠ:<br />
            â€¢ ÙÙ‡Ù… Ø§Ù„Ù…ØªØ·Ù„Ø¨Ø§Øª ÙˆØ§Ù„Ø¶ÙˆØ§Ø¨Ø· Ø§Ù„Ù‡Ù†Ø¯Ø³ÙŠØ© ÙˆØ§Ù„Ù…Ø¹Ø§ÙŠÙŠØ± Ø§Ù„Ù…Ù‡Ù†ÙŠØ©.<br />
            â€¢ ØªÙˆØ¶ÙŠØ­ Ø¢Ù„ÙŠØ§Øª Ø±Ø¨Ø· Ø§Ù„Ø§Ø´ØªØ±Ø§Ø·Ø§Øª Ø§Ù„ÙÙ†ÙŠØ© Ø¨Ù„ÙˆØ§Ø¦Ø­ Ø§Ù„Ù…Ø®Ø§Ù„ÙØ§Øª Ø§Ù„Ù‡Ù†Ø¯Ø³ÙŠØ©.<br />
            â€¢ ØªÙ„Ø®ÙŠØµ Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª ÙˆØ§Ù„Ø®Ø·ÙˆØ§Øª Ø§Ù„ØªØ´ØºÙŠÙ„ÙŠØ© Ù„Ù„Ø£Ù†Ø¸Ù…Ø© ÙˆØ§Ù„Ø®Ø¯Ù…Ø§Øª Ø§Ù„Ù‡Ù†Ø¯Ø³ÙŠØ© ÙÙŠ Ø§Ù„Ù‡ÙŠØ¦Ø©.<br />
            Ø§ÙƒØªØ¨ Ø³Ø¤Ø§Ù„Ùƒ Ù…Ø¨Ø§Ø´Ø±Ø© Ø£Ùˆ Ø§Ø®ØªØ± Ø£Ø­Ø¯ Ø§Ù„Ù…Ù‚ØªØ±Ø­Ø§Øª Ø¨Ø§Ù„Ø£Ø¹Ù„Ù‰ Ù„Ù„Ø¨Ø¯Ø¡.
          </div>
          <div class="msg-meta">
            <span>Ø§Ù„Ø¢Ù†</span> Â· <span>SCE</span>
          </div>
        </div>
      </main>

      <!-- Ø§Ù„Ø¥Ø¯Ø®Ø§Ù„ -->
      <footer class="chat-footer">
        <div class="input-row">
          <div class="input-wrap">
            <textarea
              id="chatInput"
              class="chat-input"
              rows="1"
              placeholder="Ø§ÙƒØªØ¨ Ø³Ø¤Ø§Ù„Ùƒ Ù‡Ù†Ø§..."
            ></textarea>
            <div class="input-hint">Ø§Ø¶ØºØ· Enter Ù„Ù„Ø¥Ø±Ø³Ø§Ù„</div>
          </div>
          <button id="sendBtn" class="send-btn disabled" type="button" aria-label="Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø±Ø³Ø§Ù„Ø©">
            <div class="send-icon"></div>
          </button>
        </div>
      </footer>

      <!-- Ø§Ù„Ù‡ÙˆÙŠØ© -->
      <div class="brand-strip">
        Ù…Ø·ÙˆÙ‘ÙØ± Ù„Ù€ <strong>Ø§Ø§Ù„Ù‡ÙŠØ¦Ø© Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ© Ù„Ù„Ù…Ù‡Ù†Ø¯Ø³ÙŠÙŠÙ†</strong> â€“ Ù…ØªØµÙ„ Ø¨Ù€ Ø§Ù„ÙˆÙƒÙŠÙ„ Ø§Ù„Ø°ÙƒÙŠ Ù„Ù„Ù‡ÙŠØ¦Ø©
      </div>
    </div>
  </div>

  <script>
    let threadId = null;
    const API_URL = "/api/chat";

    const chatBody = document.getElementById("chatBody");
    const chatInput = document.getElementById("chatInput");
    const sendBtn = document.getElementById("sendBtn");
    const chipsRow = document.getElementById("chipsRow");
    const sphereDots = document.getElementById("sphereDots");
    const heroSection = document.querySelector(".chat-hero");

    let loadingBubble = null;
    let hasFirstInteraction = false;

    function scrollToBottom() {
      chatBody.scrollTop = chatBody.scrollHeight;
      setTimeout(() => {
        chatBody.scrollTop = chatBody.scrollHeight;
      }, 120);
    }

    function setTypingState(isTyping) {
      if (isTyping) {
        sphereDots.classList.add("active");
      } else {
        sphereDots.classList.remove("active");
      }
    }

    function setSendEnabled(enabled) {
      if (enabled) {
        sendBtn.classList.remove("disabled");
      } else {
        sendBtn.classList.add("disabled");
      }
    }

    function addMessage(text, sender = "assistant") {
      const wrapper = document.createElement("div");
      wrapper.className = "message-group";

      const msg = document.createElement("div");
      msg.className = "msg " + (sender === "user" ? "user" : "assistant");
      msg.innerText = text;
      wrapper.appendChild(msg);

      if (sender === "assistant") {
        const meta = document.createElement("div");
        meta.className = "msg-meta";
        meta.innerHTML = `<span>Ø§Ù„Ø¢Ù†</span> Â· <span>SCE</span>`;

        const actions = document.createElement("div");
        actions.className = "msg-actions";

        const good = document.createElement("button");
        good.className = "msg-action-btn";
        good.innerHTML = `<span class="msg-action-emoji">ğŸ‘</span><span>Ù…ÙÙŠØ¯</span>`;

        const bad = document.createElement("button");
        bad.className = "msg-action-btn";
        bad.innerHTML = `<span class="msg-action-emoji">ğŸ‘</span><span>ØºÙŠØ± ÙˆØ§Ø¶Ø­</span>`;

        const copyBtn = document.createElement("button");
        copyBtn.className = "msg-action-btn";
        copyBtn.innerHTML = `<span class="msg-action-emoji">ğŸ“‹</span><span>Ù†Ø³Ø®</span>`;

        good.addEventListener("click", () => {
          good.disabled = true;
          bad.disabled = true;
          addMessage("âœ… ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ù…Ù„Ø§Ø­Ø¸ØªÙƒ. ÙŠØ³Ø¹Ø¯Ù†ÙŠ Ø£Ù† Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø© ÙƒØ§Ù†Øª Ù…ÙÙŠØ¯Ø© Ù„Ùƒ.", "assistant");
        });

        bad.addEventListener("click", () => {
          good.disabled = true;
          bad.disabled = true;
          addMessage("Ø´ÙƒØ±Ù‹Ø§ Ù„Ù…Ù„Ø§Ø­Ø¸ØªÙƒ ğŸ™.\nÙ„Ùˆ Ø­Ø§Ø¨ ØªÙˆØ¶Ø­ Ø³Ø¤Ø§Ù„Ùƒ Ø£ÙƒØ«Ø± Ø£Ùˆ ØªØ°ÙƒØ± ÙˆÙŠÙ† Ø§Ù„Ø¥Ø´ÙƒØ§Ù„ ÙÙŠ Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø©ØŒ Ø£Ù‚Ø¯Ø± Ø£Ø¹ÙŠØ¯ ØµÙŠØ§ØºØªÙ‡Ø§ Ù„Ùƒ Ø¨Ø´ÙƒÙ„ Ø£ÙˆØ¶Ø­.", "assistant");
        });

        copyBtn.addEventListener("click", () => {
          if (navigator.clipboard && window.isSecureContext) {
            navigator.clipboard.writeText(text).catch(() => {});
          } else {
            const ta = document.createElement("textarea");
            ta.value = text;
            ta.style.position = "fixed";
            ta.style.opacity = "0";
            document.body.appendChild(ta);
            ta.select();
            try {
              document.execCommand("copy");
            } catch (e) {}
            document.body.removeChild(ta);
          }
        });

        actions.appendChild(good);
        actions.appendChild(bad);
        actions.appendChild(copyBtn);

        wrapper.appendChild(meta);
        wrapper.appendChild(actions);
      }

      chatBody.appendChild(wrapper);
      setTimeout(scrollToBottom, 50);
    }

    function addLoadingBubble() {
      if (loadingBubble) return;
      const wrapper = document.createElement("div");
      wrapper.className = "message-group";

      const msg = document.createElement("div");
      msg.className = "msg assistant";
      msg.innerText = "â³ Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø¨Ø­Ø« ÙÙŠ Ù„ÙˆØ§Ø¦Ø­ ÙˆØ£Ù†Ø¸Ù…Ø© Ø§Ø§Ù„Ù‡ÙŠØ¦Ø© Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ© Ù„Ù„Ù…Ù‡Ù†Ø¯Ø³ÙŠÙŠÙ†...";
      wrapper.appendChild(msg);

      chatBody.appendChild(wrapper);
      loadingBubble = wrapper;

      setTimeout(scrollToBottom, 50);
    }

    function removeLoadingBubble() {
      if (loadingBubble && loadingBubble.parentNode) {
        loadingBubble.parentNode.removeChild(loadingBubble);
      }
      loadingBubble = null;
      setTimeout(scrollToBottom, 50);
    }

    async function callAssistantAPI(userText) {
      setTypingState(true);
      addLoadingBubble();

      try {
        const response = await fetch(API_URL, {
          method: "POST",
          headers: {
            "Content-Type": "application/json",
          },
          body: JSON.stringify({
            message: userText,
            threadId: threadId,
          }),
        });

        if (!response.ok) {
          throw new Error("HTTP " + response.status);
        }

        const data = await response.json();
        threadId = data.threadId || threadId;

        removeLoadingBubble();

        const answer = data.answer || "Ù„Ù… Ø£Ø³ØªØ·Ø¹ Ù‚Ø±Ø§Ø¡Ø© Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø© Ù…Ù† Ø§Ù„Ø®Ø¯Ù…Ø©ØŒ ØªØ£ÙƒØ¯ Ù…Ù† Ø£Ù† Ø§Ù„Ù…ÙØªØ§Ø­ 'answer' Ù…ÙˆØ¬ÙˆØ¯ ÙÙŠ Ø§Ù„Ø§Ø³ØªØ¬Ø§Ø¨Ø©.";
        addMessage(answer, "assistant");
      } catch (err) {
        console.error("API error:", err);
        removeLoadingBubble();
        addMessage("âš ï¸ Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø®Ø¯Ù…Ø©.\nØªØ£ÙƒØ¯ Ø£Ù† ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯ Ù…ØªØ§Ø­Ø© Ø«Ù… Ø­Ø§ÙˆÙ„ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰.", "assistant");
      } finally {
        setTypingState(false);
      }
    }

    function handleSend() {
      const text = chatInput.value.trim();
      if (!text || sendBtn.classList.contains("disabled")) return;

      if (!hasFirstInteraction) {
        hasFirstInteraction = true;
        if (heroSection) {
          heroSection.style.display = "none";
        }
        setTimeout(scrollToBottom, 80);
      }

      addMessage(text, "user");
      chatInput.value = "";
      chatInput.style.height = "40px";
      setSendEnabled(false);

      callAssistantAPI(text);
    }

    chatInput.addEventListener("input", () => {
      setSendEnabled(chatInput.value.trim().length > 0);
      chatInput.style.height = "auto";
      chatInput.style.height = Math.min(chatInput.scrollHeight, 80) + "px";
    });

    chatInput.addEventListener("keydown", (e) => {
      if (e.key === "Enter" && !e.shiftKey) {
        e.preventDefault();
        handleSend();
      }
    });

    chatInput.addEventListener("focus", () => {
      setTimeout(scrollToBottom, 250);
    });

    sendBtn.addEventListener("click", handleSend);

    chipsRow.addEventListener("click", (e) => {
      const chip = e.target.closest(".chip");
      if (!chip) return;
      const text = chip.getAttribute("data-text");
      if (!text) return;
      chatInput.value = text;
      chatInput.dispatchEvent(new Event("input"));
      handleSend();
    });

    window.addEventListener("load", () => {
      setTypingState(false);
    });

    window.addEventListener("orientationchange", () => {
      setTimeout(scrollToBottom, 400);
    });
  </script>
</body>
</html>
